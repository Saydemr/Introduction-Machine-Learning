-----------------------------------------------------------------
K =  10
E =  50
d =  100
N =  1000
N_test =  1000
Learning rate =  0.07
Starting the process...

Epoch:  1 Training Accuracy:  0.233 Testing Accuracy:  0.233
Epoch:  2 Training Accuracy:  0.279 Testing Accuracy:  0.282
Epoch:  3 Training Accuracy:  0.423 Testing Accuracy:  0.397
Epoch:  4 Training Accuracy:  0.537 Testing Accuracy:  0.484
Epoch:  5 Training Accuracy:  0.56 Testing Accuracy:  0.528
Epoch:  6 Training Accuracy:  0.667 Testing Accuracy:  0.636
Epoch:  7 Training Accuracy:  0.609 Testing Accuracy:  0.57
Epoch:  8 Training Accuracy:  0.62 Testing Accuracy:  0.579
Epoch:  9 Training Accuracy:  0.465 Testing Accuracy:  0.458
Epoch:  10 Training Accuracy:  0.605 Testing Accuracy:  0.54
Epoch:  11 Training Accuracy:  0.668 Testing Accuracy:  0.607
Epoch:  12 Training Accuracy:  0.726 Testing Accuracy:  0.619
Epoch:  13 Training Accuracy:  0.729 Testing Accuracy:  0.635
Epoch:  14 Training Accuracy:  0.793 Testing Accuracy:  0.699
Epoch:  15 Training Accuracy:  0.785 Testing Accuracy:  0.701
Epoch:  16 Training Accuracy:  0.838 Testing Accuracy:  0.745
Epoch:  17 Training Accuracy:  0.846 Testing Accuracy:  0.739
Epoch:  18 Training Accuracy:  0.87 Testing Accuracy:  0.781
Epoch:  19 Training Accuracy:  0.872 Testing Accuracy:  0.76
Epoch:  20 Training Accuracy:  0.889 Testing Accuracy:  0.796
Epoch:  21 Training Accuracy:  0.895 Testing Accuracy:  0.776
Epoch:  22 Training Accuracy:  0.895 Testing Accuracy:  0.792
Epoch:  23 Training Accuracy:  0.905 Testing Accuracy:  0.784
Epoch:  24 Training Accuracy:  0.89 Testing Accuracy:  0.792
Epoch:  25 Training Accuracy:  0.908 Testing Accuracy:  0.786
Epoch:  26 Training Accuracy:  0.906 Testing Accuracy:  0.792
Epoch:  27 Training Accuracy:  0.92 Testing Accuracy:  0.807
Epoch:  28 Training Accuracy:  0.903 Testing Accuracy:  0.793
Epoch:  29 Training Accuracy:  0.922 Testing Accuracy:  0.805
Epoch:  30 Training Accuracy:  0.899 Testing Accuracy:  0.792
Epoch:  31 Training Accuracy:  0.915 Testing Accuracy:  0.791
Epoch:  32 Training Accuracy:  0.919 Testing Accuracy:  0.8
Epoch:  33 Training Accuracy:  0.923 Testing Accuracy:  0.799
Epoch:  34 Training Accuracy:  0.903 Testing Accuracy:  0.789
Epoch:  35 Training Accuracy:  0.902 Testing Accuracy:  0.798
Epoch:  36 Training Accuracy:  0.897 Testing Accuracy:  0.789
Epoch:  37 Training Accuracy:  0.91 Testing Accuracy:  0.795
Epoch:  38 Training Accuracy:  0.907 Testing Accuracy:  0.791
Epoch:  39 Training Accuracy:  0.902 Testing Accuracy:  0.791
Epoch:  40 Training Accuracy:  0.913 Testing Accuracy:  0.789
Epoch:  41 Training Accuracy:  0.917 Testing Accuracy:  0.791
Epoch:  42 Training Accuracy:  0.937 Testing Accuracy:  0.8
Epoch:  43 Training Accuracy:  0.939 Testing Accuracy:  0.808
Epoch:  44 Training Accuracy:  0.929 Testing Accuracy:  0.802
Epoch:  45 Training Accuracy:  0.933 Testing Accuracy:  0.819
Epoch:  46 Training Accuracy:  0.918 Testing Accuracy:  0.793
Epoch:  47 Training Accuracy:  0.927 Testing Accuracy:  0.807
Epoch:  48 Training Accuracy:  0.915 Testing Accuracy:  0.784
Epoch:  49 Training Accuracy:  0.913 Testing Accuracy:  0.808
Epoch:  50 Training Accuracy:  0.898 Testing Accuracy:  0.768

Confusion Matrix Training:
[94.  0.  0.  0.  0.  0.  0.  1.  0.  0.]
[ 1. 95.  2.  1.  1.  0.  0.  3.  0.  0.]
[ 1.  2. 92.  1.  6.  0.  0.  6.  1.  0.]
[ 0.  0.  0. 97.  0.  1.  0.  0.  5.  0.]
[ 1.  0.  2.  0. 92.  0.  0.  9.  1.  0.]
[ 0.  0.  0.  1.  1. 99.  0.  1.  0.  0.]
[  2.   1.   1.   0.   0.   0. 100.   1.   3.   0.]
[ 1.  0.  2.  0.  0.  0.  0. 76.  0.  0.]
[ 0.  1.  1.  0.  0.  0.  0.  3. 88.  0.]
[  0.   1.   0.   0.   0.   0.   0.   0.   2. 100.]

Confusion Matrix Test:
[91.  0.  0.  1.  1.  0.  0.  1.  0.  0.]
[ 0. 82.  1.  0.  2.  3.  4.  1.  0.  0.]
[ 8.  3. 84.  2.  5.  0.  5. 10.  5.  2.]
[ 0.  0.  1. 81.  6.  1.  3.  6.  3.  0.]
[ 0.  0. 12.  0. 73.  5.  1.  8.  1.  3.]
[ 0.  3.  1.  4.  0. 88.  0.  2.  0.  2.]
[ 0.  3.  0.  0.  7.  0. 82.  1.  7.  0.]
[ 1.  7.  1.  0.  2.  1.  1. 62.  0.  1.]
[ 0.  2.  0. 12.  4.  0.  4.  9. 84.  0.]
[ 0.  0.  0.  0.  0.  2.  0.  0.  0. 92.]

Best Accuracy:  0.819
./single_layer.py:22: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
./single_layer.py:167: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
